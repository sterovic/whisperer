<% content_for :title, "Import Videos - Whisperer" %>

<div>
  <!-- Page Header -->
  <div class="mb-6">
    <div class="flex items-center gap-2 text-sm text-base-content/60 mb-2">
      <%= link_to root_path, class: "hover:text-base-content transition-colors" do %>
        <span class="block iconify lucide--home size-4"></span>
      <% end %>
      <span class="iconify lucide--chevron-right size-3"></span>
      <%= link_to "Videos", videos_path, class: "hover:text-base-content transition-colors" %>
      <span class="iconify lucide--chevron-right size-3"></span>
      <span class="text-base-content">Import</span>
    </div>
    <div class="flex items-center justify-between gap-4">
      <div>
        <h1 class="text-2xl font-bold">Import YouTube Videos</h1>
        <p class="text-base-content/60 text-sm mt-1">Add videos to your project by pasting YouTube URLs</p>
      </div>
      <%= link_to videos_path, class: "btn btn-ghost gap-2" do %>
        <span class="iconify lucide--arrow-left size-4"></span>
        Back to Videos
      <% end %>
    </div>
  </div>

  <% if current_project.nil? %>
    <div class="alert alert-warning mb-6">
      <span class="iconify lucide--alert-triangle size-5"></span>
      <span>Please select a project before importing videos.</span>
    </div>
  <% end %>

  <div class="grid grid-cols-1 xl:grid-cols-3 gap-6">
    <!-- Import Form -->
    <div class="xl:col-span-2">
      <%= form_with url: import_videos_path, method: :post, data: { turbo_stream: true } do |f| %>
        <div class="bg-base-100 rounded-box border border-base-300 p-6">
          <h2 class="text-lg font-semibold mb-1 flex items-center gap-2">
            <span class="iconify lucide--link size-5 text-base-content/70"></span>
            YouTube URLs
          </h2>
          <p class="text-sm text-base-content/60 mb-5">
            Enter one URL per line. Supported formats: youtube.com/watch?v=..., youtu.be/..., youtube.com/shorts/...
          </p>

          <div class="fieldset space-y-5">
            <div class="space-y-2">
              <label for="urls" class="fieldset-label">Video URLs</label>
              <%= f.text_area :urls,
                              id: "urls",
                              rows: 8,
                              class: "textarea w-full font-mono text-sm",
                              placeholder: "https://www.youtube.com/watch?v=dQw4w9WgXcQ\nhttps://youtu.be/dQw4w9WgXcQ",
                              disabled: current_project.nil? %>
              <p class="text-xs text-base-content/50">One URL per line</p>
            </div>
          </div>
        </div>

        <!-- Import Options -->
        <div class="bg-base-100 rounded-box border border-base-300 p-6 mt-6">
          <h2 class="text-lg font-semibold mb-1 flex items-center gap-2">
            <span class="iconify lucide--settings-2 size-5 text-base-content/70"></span>
            Import Options
          </h2>
          <p class="text-sm text-base-content/60 mb-5">
            Configure additional import settings.
          </p>

          <div class="space-y-4">
            <label class="flex items-start gap-3 cursor-pointer">
              <%= f.check_box :import_existing_comments,
                              { class: "checkbox checkbox-sm checkbox-primary mt-0.5", disabled: current_project.nil? },
                              "1", "0" %>
              <span>
                <span class="text-sm font-medium">Import existing comments</span>
                <span class="block text-xs text-base-content/50">
                  Find and import comments that mention "<strong><%= current_project&.name || "your product" %></strong>" as manual comments
                </span>
              </span>
            </label>
          </div>
        </div>

        <!-- Submit -->
        <div class="flex justify-end mt-6">
          <%= f.submit "Import Videos",
                       class: "btn btn-primary gap-2",
                       disabled: current_project.nil?,
                       data: { turbo_submits_with: "Importing..." } %>
        </div>
      <% end %>
    </div>

    <!-- Help Section -->
    <div class="xl:col-span-1">
      <div class="bg-base-100 rounded-box border border-base-300 p-6">
        <div class="flex items-start gap-3">
          <span class="iconify lucide--info size-5 text-info mt-0.5"></span>
          <div class="text-sm">
            <p class="font-medium mb-2">How It Works</p>
            <ol class="text-base-content/70 space-y-1 list-decimal list-inside">
              <li>Paste YouTube video URLs, one per line</li>
              <li>Optionally enable comment import</li>
              <li>Click "Import Videos" to start</li>
              <li>Watch the progress below</li>
            </ol>
          </div>
        </div>

        <div class="divider my-4"></div>

        <div class="text-sm text-base-content/60">
          <p class="font-medium mb-2">Imported data includes:</p>
          <ul class="list-disc list-inside space-y-1">
            <li>Video title and description</li>
            <li>Thumbnail image</li>
            <li>View, like, and comment counts</li>
            <li>Channel information</li>
          </ul>
        </div>

        <% if current_project %>
          <div class="divider my-4"></div>

          <div class="text-sm">
            <p class="font-medium mb-2">Comment Import</p>
            <p class="text-base-content/60">
              When enabled, we'll scan each video's comments for mentions of
              "<strong class="text-base-content"><%= current_project.name %></strong>"
              and import matching comments as manual entries.
            </p>
          </div>
        <% end %>
      </div>
    </div>
  </div>

</div>
