<input
  type="checkbox"
  id="layout-sidebar-toggle-trigger"
  class="hidden"
  aria-label="Toggle layout sidebar"/>
<input
  type="checkbox"
  id="layout-sidebar-hover-trigger"
  class="hidden"
  aria-label="Dense layout sidebar"/>
<div id="layout-sidebar-hover" class="bg-base-300 h-screen w-1"></div>

<div id="layout-sidebar" class="sidebar-menu sidebar-menu-activation">
  <div class="flex min-h-16 items-center justify-between gap-3 ps-5 pe-4">
    <%= link_to root_path, class: "logo flex items-center gap-2" do %>
      <%= image_tag "full_logo.svg", alt: "Whisperer", class: "h-9" %>
    <% end %>
    <label
      for="layout-sidebar-hover-trigger"
      title="Toggle sidebar hover"
      class="btn btn-circle btn-ghost btn-sm text-base-content/50 relative max-lg:hidden">
            <span
              class="iconify lucide--panel-left-close absolute size-4.5 opacity-100 transition-all duration-300 group-has-[[id=layout-sidebar-hover-trigger]:checked]/html:opacity-0"></span>
      <span
        class="iconify lucide--panel-left-dashed absolute size-4.5 opacity-0 transition-all duration-300 group-has-[[id=layout-sidebar-hover-trigger]:checked]/html:opacity-100"></span>
    </label>
  </div>
  <%= render "shared/ui/project_switcher" %>
  <div class="relative min-h-0 grow mt-4">
    <div data-simplebar class="size-full">
      <div class="mb-3 space-y-0.5 px-2.5">
        <p class="menu-label px-2.5 pt-3 pb-1.5 first:pt-0">Overview</p>
        <%= link_to dashboard_path, class: "menu-item #{current_page?(dashboard_path) || current_page?(root_path) ? 'active' : ''}" do %>
          <span class="iconify lucide--monitor size-4"></span>
          <span class="grow">Dashboard</span>
        <% end %>
        <%= link_to jobs_path, class: "menu-item #{current_page?(jobs_path) ? 'active' : ''}" do %>
          <span class="iconify lucide--briefcase size-4"></span>
          <span class="grow">Jobs</span>
        <% end %>
        <% videos_active = controller_name == 'videos' || controller_name == 'video_searches' %>
        <div class="group collapse <%= 'collapse-open' if videos_active %>">
          <input
            aria-label="Sidemenu item trigger"
            type="checkbox"
            class="peer"
            name="sidebar-menu-videos"
            <%= 'checked' if videos_active %> />
          <div class="collapse-title px-2.5 py-1.5">
            <span class="iconify lucide--video size-4"></span>
            <span class="grow">Videos</span>
            <% if @new_channel_videos_count && @new_channel_videos_count > 0 %>
              <span class="badge badge-primary badge-xs text-[10px] font-bold px-1.5 py-0.5"><%= @new_channel_videos_count > 99 ? "99+" : @new_channel_videos_count %></span>
            <% end %>
            <span class="iconify lucide--chevron-right arrow-icon size-3.5"></span>
          </div>
          <div class="collapse-content ms-6.5 !p-0">
            <div class="mt-0.5 space-y-0.5">
              <%= link_to videos_path, class: "menu-item #{controller_name == 'videos' && action_name == 'index' ? 'active' : ''}" do %>
                <span class="grow">Videos</span>
              <% end %>
              <%= link_to import_videos_path, class: "menu-item #{controller_name == 'videos' && action_name == 'import' ? 'active' : ''}" do %>
                <span class="grow">Import</span>
              <% end %>
              <%= link_to video_searches_path, class: "menu-item #{controller_name == 'video_searches' ? 'active' : ''}" do %>
                <span class="grow">Search</span>
              <% end %>
            </div>
          </div>
        </div>
        <% channels_active = controller_name == 'channels' || controller_path.start_with?('channels') %>
        <div class="group collapse <%= 'collapse-open' if channels_active %>">
          <input
            aria-label="Sidemenu item trigger"
            type="checkbox"
            class="peer"
            name="sidebar-menu-channels"
            <%= 'checked' if channels_active %> />
          <div class="collapse-title px-2.5 py-1.5">
            <span class="iconify lucide--radio size-4"></span>
            <span class="grow">Channels</span>
            <span class="iconify lucide--chevron-right arrow-icon size-3.5"></span>
          </div>
          <div class="collapse-content ms-6.5 !p-0">
            <div class="mt-0.5 space-y-0.5">
              <%= link_to channels_path, class: "menu-item #{controller_name == 'channels' && action_name == 'index' ? 'active' : ''}" do %>
                <span class="grow">All Channels</span>
              <% end %>
              <%= link_to channels_subscriptions_path, class: "menu-item #{controller_path == 'channels/subscriptions' && action_name != 'new' ? 'active' : ''}" do %>
                <span class="grow">Subscriptions</span>
              <% end %>
              <%= link_to new_channels_subscription_path, class: "menu-item #{controller_path == 'channels/subscriptions' && action_name == 'new' ? 'active' : ''}" do %>
                <span class="grow">Subscribe</span>
              <% end %>
            </div>
          </div>
        </div>
        <%= link_to google_accounts_path, class: "menu-item #{controller_name == 'google_accounts' ? 'active' : ''}" do %>
          <span class="iconify lucide--user-circle size-4"></span>
          <span class="grow">Google Accounts</span>
        <% end %>
        <%= link_to comments_path, class: "menu-item #{controller_name == 'comments' ? 'active' : ''}" do %>
          <span class="iconify lucide--message-circle size-4"></span>
          <span class="grow">Comments</span>
        <% end %>
        <% settings_active = controller_name == 'prompt_settings' || controller_path.start_with?('settings') %>
        <div class="group collapse <%= 'collapse-open' if settings_active %>">
          <input
            aria-label="Sidemenu item trigger"
            type="checkbox"
            class="peer"
            name="sidebar-menu-settings"
            <%= 'checked' if settings_active %> />
          <div class="collapse-title px-2.5 py-1.5">
            <span class="iconify lucide--settings size-4"></span>
            <span class="grow">Settings</span>
            <span class="iconify lucide--chevron-right arrow-icon size-3.5"></span>
          </div>
          <div class="collapse-content ms-6.5 !p-0">
            <div class="mt-0.5 space-y-0.5">
              <%= link_to settings_project_path, class: "menu-item #{controller_path == 'settings/project' ? 'active' : ''}" do %>
                <span class="grow">General</span>
              <% end %>
              <%= link_to prompt_settings_path, class: "menu-item #{controller_name == 'prompt_settings' ? 'active' : ''}" do %>
                <span class="grow">AI/Prompt</span>
              <% end %>
            </div>
          </div>
        </div>
        <% smm_panels_active = controller_path.start_with?('smm_panels') || controller_name == 'smm_orders' %>
        <div class="group collapse <%= 'collapse-open' if smm_panels_active %>">
          <input
            aria-label="Sidemenu item trigger"
            type="checkbox"
            class="peer"
            name="sidebar-menu-smm-panels"
            <%= 'checked' if smm_panels_active %> />
          <div class="collapse-title px-2.5 py-1.5">
            <span class="iconify lucide--share-2 size-4"></span>
            <span class="grow">SMM Panels</span>
            <span class="iconify lucide--chevron-right arrow-icon size-3.5"></span>
          </div>
          <div class="collapse-content ms-6.5 !p-0">
            <div class="mt-0.5 space-y-0.5">
              <%= link_to smm_panels_jap_index_path, class: "menu-item #{controller_path == 'smm_panels/jap' ? 'active' : ''}" do %>
                <span class="grow">JAP</span>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="from-base-100/60 pointer-events-none absolute start-0 end-0 bottom-0 h-7 bg-linear-to-t to-transparent"></div>
  </div>
  <%= render "shared/ui/plan_usage_stats" %>
</div>

<label for="layout-sidebar-toggle-trigger" id="layout-sidebar-backdrop"></label>